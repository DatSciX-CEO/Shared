Deduplicated Count by Primary Job Type =
VAR
    // Step 1: Create a virtual table of all relevant placements and assign a priority rank to each.
    PlacementsWithRank =
    ADDCOLUMNS (
        FILTER (
            'Datalake_Bullhorn_Query',
            'Datalake_Bullhorn_Query'[Job_Type]
                IN {
                    "ELS Managed Services",
                    "Advisory",
                    "Legal Staffing",
                    "Support Staffing",
                    "Direct Review"
                }
        ),
        "PlacementRank",
        SWITCH (
            TRUE (),
            'Datalake_Bullhorn_Query'[Job_Type] = "ELS Managed Services", 1,
            'Datalake_Bullhorn_Query'[Job_Type] = "Advisory", 2,
            'Datalake_Bullhorn_Query'[Job_Type] = "Legal Staffing", 3,
            'Datalake_Bullhorn_Query'[Job_Type] = "Support Staffing", 4,
            'Datalake_Bullhorn_Query'[Job_Type] = "Direct Review", 5,
            999 // Fallback rank
        )
    )
VAR
    // Step 2: Using the ranked list, create a definitive table of each unique candidate
    // and their single, highest-priority Job Type.
    CandidatePrimaryJobType =
    GROUPBY (
        PlacementsWithRank,
        'Datalake_Bullhorn_Query'[CandidateID],
        "PrimaryJobType",
        VAR CurrentCandidateGroup = CURRENTGROUP ()
        VAR TopRank = MINX ( CurrentCandidateGroup, [PlacementRank] )
        VAR Result =
            MINX (
                FILTER ( CurrentCandidateGroup, [PlacementRank] = TopRank ),
                'Datalake_Bullhorn_Query'[Job_Type]
            )
        RETURN
            Result
    )
VAR
    // Step 3: In any visual, determine which Job Types are currently being shown or filtered.
    SelectedJobTypes =
    VALUES ( 'Datalake_Bullhorn_Query'[Job_Type] )
VAR
    // Step 4: Filter our definitive candidate list (from Step 2) to only include candidates
    // whose primary job type is visible in the current context (from Step 3).
    FinalCandidatesToCount =
    FILTER (
        CandidatePrimaryJobType,
        [PrimaryJobType] IN SelectedJobTypes
    )
RETURN
    // Step 5: Count the rows of that final, filtered list of candidates.
    COUNTROWS ( FinalCandidatesToCount )